@{
    ViewData["Title"] = "Import Words from CSV";
}

<div class="max-w-3xl mx-auto">
    <div class="mb-8">
        <h1 class="text-2xl font-bold text-slate-900 dark:text-slate-100">Import Words from CSV</h1>
        <p class="text-slate-500 dark:text-slate-400">Upload a CSV file to add multiple words at once</p>
    </div>

    @if (TempData["Error"] != null)
    {
        <div class="mb-6 bg-red-50 dark:bg-red-900/30 border border-red-200 dark:border-red-700 text-red-700 dark:text-red-300 px-4 py-3 rounded relative" role="alert">
            <span class="block sm:inline">@TempData["Error"]</span>
        </div>
    }

    <!-- Instructions Card -->
    <div class="bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-xl p-6 mb-8">
        <h3 class="font-bold text-blue-900 dark:text-blue-300 mb-3 flex items-center gap-2">
            <i class="fa-solid fa-circle-info"></i>
            CSV File Format
        </h3>
        <p class="text-blue-800 dark:text-blue-400 text-sm mb-3">
            Your CSV file should have the following columns (header required):
        </p>
        <div class="bg-white dark:bg-slate-800 rounded-lg p-4 font-mono text-sm mb-3 overflow-x-auto">
            <div class="text-slate-600 dark:text-slate-400 mb-2">Word,Translation,PartOfSpeech,Difficulty,LanguageFrom,LanguageTo</div>
            <div class="text-slate-800 dark:text-slate-200">hello,مرحبا,Noun,Easy,en,ar</div>
            <div class="text-slate-800 dark:text-slate-200">run,يجري,Verb,Medium,en,ar</div>
        </div>
        <div class="text-blue-800 dark:text-blue-400 text-sm space-y-1">
            <p><strong>Required:</strong> Word, Translation</p>
            <p><strong>Optional:</strong> PartOfSpeech (Noun/Verb/Adjective/etc), Difficulty (Easy/Medium/Hard), LanguageFrom (default: en), LanguageTo (default: ar)</p>
        </div>
    </div>

    <!-- Upload Form -->
    <div class="bg-white dark:bg-slate-800 rounded-xl shadow-sm border border-slate-200 dark:border-slate-700 p-8">
        <form asp-action="ImportCsv" method="post" enctype="multipart/form-data" class="space-y-6">
            @Html.AntiForgeryToken()
            
            <div>
                <label class="block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2">
                    Select CSV File
                </label>
                <div class="flex items-center justify-center w-full">
                    <label for="file" class="flex flex-col items-center justify-center w-full h-64 border-2 border-slate-300 dark:border-slate-600 border-dashed rounded-lg cursor-pointer bg-slate-50 dark:bg-slate-700/50 hover:bg-slate-100 dark:hover:bg-slate-700 transition-colors">
                        <div class="flex flex-col items-center justify-center pt-5 pb-6">
                            <i class="fa-solid fa-cloud-arrow-up text-4xl text-slate-400 dark:text-slate-500 mb-3"></i>
                            <p class="mb-2 text-sm text-slate-500 dark:text-slate-400">
                                <span class="font-semibold">Click to upload</span> or drag and drop
                            </p>
                            <p class="text-xs text-slate-500 dark:text-slate-400">CSV files only</p>
                            <p id="file-name" class="mt-2 text-sm text-primary-600 dark:text-primary-400 font-medium"></p>
                        </div>
                        <input id="file" name="file" type="file" accept=".csv" class="hidden" required />
                    </label>
                </div>
            </div>

            <div class="flex gap-3">
                <button type="submit" class="flex-1 bg-primary-600 hover:bg-primary-700 text-white px-6 py-3 rounded-lg font-medium transition-colors">
                    <i class="fa-solid fa-file-import mr-2"></i>
                    Import Words
                </button>
                <a asp-action="Index" class="px-6 py-3 border border-slate-300 dark:border-slate-600 text-slate-700 dark:text-slate-300 rounded-lg font-medium hover:bg-slate-50 dark:hover:bg-slate-700 transition-colors">
                    Cancel
                </a>
            </div>
        </form>
    </div>

    <!-- Sample CSV Download -->
    <div class="mt-6 text-center">
        <p class="text-sm text-slate-500 dark:text-slate-400 mb-2">Need a template?</p>
        <button onclick="downloadSampleCsv()" class="text-primary-600 dark:text-primary-400 hover:underline text-sm font-medium">
            <i class="fa-solid fa-download mr-1"></i>
            Download Sample CSV
        </button>
    </div>
</div>

<script>
    // Show selected file name
    document.getElementById('file').addEventListener('change', function(e) {
        const fileName = e.target.files[0]?.name || '';
        document.getElementById('file-name').textContent = fileName ? `Selected: ${fileName}` : '';
    });

    // Generate and download sample CSV
    function downloadSampleCsv() {
        const csvContent = `Word,Translation,PartOfSpeech,Difficulty,LanguageFrom,LanguageTo
hello,مرحبا,Noun,Easy,en,ar
run,يجري,Verb,Medium,en,ar
beautiful,جميل,Adjective,Medium,en,ar
quickly,بسرعة,Adverb,Hard,en,ar
book,كتاب,Noun,Easy,en,ar`;
        
        const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
        const link = document.createElement('a');
        link.href = URL.createObjectURL(blob);
        link.download = 'sample_vocabulary.csv';
        link.click();
    }
</script>
